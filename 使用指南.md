# RedPockets 使用指南

本指南将详细介绍如何使用 RedPockets 插件的所有功能。

## 目录

- [快速开始](#快速开始)
- [金币红包](#金币红包)
- [物品红包](#物品红包)
- [抢红包](#抢红包)
- [预览功能](#预览功能)
- [常见问题](#常见问题)

## 快速开始

### 基本命令

```
/redpocket          - 打开红包主界面
/grab <红包ID>       - 抢红包
```

### 第一个红包

1. 在游戏中输入 `/redpocket`
2. 在弹出的 GUI 中选择"金币红包"或"物品红包"
3. 按照提示设置参数
4. 点击"确认发送"

## 金币红包

### 什么是金币红包

金币红包是一种基于游戏内货币的红包，玩家抢到红包后会获得对应的金币。

### 创建步骤

1. **打开创建界面**
   ```
   /redpocket
   ```
   点击"金币红包"图标

2. **设置总金额**
   - 点击"总金额"物品
   - 在聊天栏输入金额（例如：`100`）
   - 输入 `cancel` 可取消

3. **设置数量**
   - 点击"数量"物品
   - 在聊天栏输入数量（例如：`10`）
   - 数量表示红包可以被多少人抢

4. **选择分配方式**
   - **随机分配**：每人抢到的金额随机，可能出现"手气最佳"
   - **平均分配**：每个人抢到的金额相同

5. **设置备注（可选）**
   - 点击"设置备注"物品
   - 在聊天栏输入备注信息

6. **确认发送**
   - 检查设置是否正确
   - 点击"确认发送"
   - 红包将发送给所有在线玩家

### 分配方式详解

#### 随机分配

- 系统会根据总金额和数量随机分配
- 每个人抢到的金额不同
- 抢到最多的人会在红包抢完后显示"气运最佳"
- 适合增加趣味性和互动性

#### 平均分配

- 总金额平均分配给每个人
- 每个人抢到的金额相同
- 适合公平分配场景

## 物品红包

### 什么是物品红包

物品红包允许发送者放入物品，其他玩家随机抽取。这是给朋友送礼物的好方式！

### 创建步骤

1. **打开创建界面**
   ```
   /redpocket
   ```
   点击"物品红包"图标

2. **编辑物品**
   - 点击"编辑物品"图标
   - 打开物品编辑界面（54个格子）
   - 将想要送的物品拖入编辑区域
   - 可以放入多种物品，每种物品一个格子
   - 物品数量可以堆叠

3. **返回主界面**
   - 关闭编辑界面会自动保存
   - 回到创建界面

4. **确认发送**
   - 查看物品数量
   - 点击"确认发送"
   - 红包将发送给所有在线玩家

### 物品红包特性

- **随机抽取**：玩家会随机抽到其中一个物品
- **唯一性**：每个物品只能被抢一次
- **自动锁定**：发送后物品自动锁定，无法修改
- **过期返还**：红包过期后未领完的物品自动退回

### 注意事项

- 确保物品已放入编辑区域
- 发送前请确认物品设置
- 红包过期后物品会自动退回

## 抢红包

### 方法一：点击聊天栏链接

当有人发送红包时，聊天栏会显示：
```
玩家 xxx 发送了 10 个价值为 100 元的 随机红包，[点击这里抢红包]
```

直接点击绿色的"点击这里抢红包"文本即可抢红包。

### 方法二：使用命令

```
/grab <红包ID>
```

需要知道红包的 ID 才能抢取。

### 查看红包ID

在聊天栏中点击"类型"文字可以查看红包 ID。

## 预览功能

### 物品红包预览

在物品红包的广播消息中，点击"物品红包"文本可以预览红包内容：

```
玩家 xxx 发送了一个 物品红包，共包含 5 件物品，[点击查看]
```

预览功能可以让你看到红包里有什么物品，但**无法拿取物品**。

### 预览注意事项

- 预览界面是只读的
- 无法从预览中拿取物品
- 预览数据保存在内存中
- 红包过期或领完后预览自动消失

## 常见问题

### Q: 我抢红包提示余额不足怎么办？

**A**: 金币红包需要经济系统支持。请确保：
1. 已安装 Vault 插件
2. 已安装经济插件（如 Essentials）
3. 服务器已启用经济功能

### Q: 红包过期后物品去哪了？

**A**: 物品红包过期后：
1. 未被领完的物品会自动退回发送者
2. 可以通过物品编辑界面查看剩余物品
3. 重新打开物品编辑界面即可看到返还的物品

### Q: 如何修改已发送的红包？

**A**: 已发送的红包无法修改：
- 金币红包：发送后金额和数量固定
- 物品红包：发送后物品自动锁定

### Q: 为什么物品红包的物品被领完了，编辑界面还是只读？

**A**: 这种情况可能是 Bug，请：
1. 等待几秒钟刷新
2. 重新打开编辑界面
3. 如果问题持续，请联系管理员

### Q: 我能看到别人抢了什么吗？

**A**: 可以，系统会实时广播：
- 金币红包：显示抢到的金额
- 物品红包：显示抢到的物品名称和数量

### Q: 如何删除红包？

**A**: 只有管理员可以删除红包：
```
/redpocketadmin delete <红包ID>
```

### Q: 数据丢失了怎么办？

**A**: 请定期备份数据库：
- MySQL：定期备份 `redpockets` 数据库
- SQLite：备份 `plugins/RedPockets/redpockets.db` 文件

### Q: 支持哪些经济插件？

**A**: 支持所有兼容 Vault 的经济插件：
- EssentialsX
- CMI
- VaultEconomy
- 其他主流经济插件

### Q: 红包的最大金额和数量是多少？

**A**: 可以在 `config.yml` 中配置：
```yaml
redpocket:
  max-amount: 100000.0  # 最大金额
  max-count: 100         # 最大数量
```

## 技巧与建议

1. **备注功能**：给红包添加备注，让红包更有意义
2. **预览物品**：抢物品红包前先预览，了解有哪些物品
3. **平均分配**：公平分配时选择平均分配模式
4. **随机分配**：增加互动趣味时选择随机分配模式
5. **注意过期时间**：默认 1 小时过期，记得及时抢

## 联系支持

如有其他问题或建议，请联系插件管理员或查看官方文档。
